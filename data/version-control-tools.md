## version-control-tools MD table
Generated on: 2019-06-15T12:01:20

| Commit Number | Commiter | Commit Message | Commit Url | Date | 
|:-----:|:-----:|:----------------------------------:|:------:|:----:| 
|1|Connor Sheehan |format-source: enable compatibility with Mercurial 5.0 ( [Bug 1545236](https://bugzilla.mozilla.org/show_bug.cgi?id=1545236)  ) r=andiformat-source was never made compatible with Mercurial 5.0, sincethe extension was disabled on Firefox developer machines. Nowthat we plan to use the extension for a JavaScript reformat using`prettier`, the extension will need to be compatible with newerversions of Mercurial.In this commit we apply compatibility patches fro.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b53f77f17586 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b53f77f17586)|2019-06-13 15:00:50
|2|Connor Sheehan |py3: global replace `iteritems( )` with `items( )` ( [Bug 1541166](https://bugzilla.mozilla.org/show_bug.cgi?id=1541166)  ) r=lars`iteritems( )` doesn't exist in Py3, with `items( )` instead returninga generator by default. This commit switches all instances of theold `iteritems` method with `items`. In all cases except one, wewere evaluating the full list of items regardless of the generatorbased function call, and the instance where we were only returneda s.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=6b4c5f3ae719 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=6b4c5f3ae719)|2019-06-12 14:40:33
|3|Connor Sheehan |testing: fix tests regressed by 2d01795bd96aA few tests were not updated with the addition of `cinnabarclone`.This commit fixes them.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3ba369fc91d0)|2019-06-10 19:30:59
|4|Connor Sheehan |ansible/ius-repo: install from most recent available repo ( [Bug 1557772](https://bugzilla.mozilla.org/show_bug.cgi?id=1557772)  ) r=globThe outdated IUS repo was identified as the source of thefailure in the attached bug. Installing from the latest fixesthe docker build issues.Differential Revision: https://phabricator.services.mozilla.com/D34239|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=af428d1296fc)|2019-06-10 14:17:00
|5|Mike Hommey |[Bug 1550183](https://bugzilla.mozilla.org/show_bug.cgi?id=1550183)  - Deploy the cinnabarclone extension to the mercurial servers. r=sheehanThe extension comes from https://github.com/glandium/git-cinnabar/blob/master/mercurial/cinnabarclone.pyand has been tested with all mercurial versions from 1.9 to 5.0.Differential Revision: https://phabricator.services.mozilla.com/D30421|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2d01795bd96a)|2019-06-07 00:14:24
|6|Connor Sheehan |ansible: assign aliases to hosts in Ansible inventoryThis will allow us to use Ansible to run commands on specifichosts without using the IP addresses.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8fe882f771b2)|2019-06-06 19:13:56
|7|Connor Sheehan |pushlog: send `templateutil.date` to template layer instead of raw hg date data ( [Bug 1556018](https://bugzilla.mozilla.org/show_bug.cgi?id=1556018)  ) r=larsSee the bug description for more details. This commit passes the rawMercurial date tuple into a `templateutil.date` object. This will enablethe correct behaviour when displaying the raw output of `pushdate`,and allow formatting with date template keywords and functions.The `showfmt` keyword argument.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=25dcf375258b )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=25dcf375258b)|2019-06-06 16:52:00
|8|Connor Sheehan |pushlog: add new output to `test-pull-obsolete.t` ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globAlso mark as compatible with Mercurial 5.0Differential Revision: https://phabricator.services.mozilla.com/D33846|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0461ff7338e8)|2019-06-06 13:27:26
|9|Connor Sheehan |overlay: rename `copied` keyword argument to `copysource` under 5.0+ ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globAlso mark as compatible with Mercurial 5.0.Depends on D33846Differential Revision: https://phabricator.services.mozilla.com/D33847|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=465163f8a58a)|2019-06-06 13:27:26
|10|Connor Sheehan |hgmo: mark as compatible with Mercurial 5.0 ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globOnly a minor test change needed for passing tests. The testin question is related to wire protocol version two, whichcan arguably be removed anyways.Depends on D33847Differential Revision: https://phabricator.services.mozilla.com/D33848|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=cca19bee710d)|2019-06-06 13:27:26
|11|Connor Sheehan |hghooks: enable test compatibility under Mercurial 5.0 ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globTests are passing without any changes, with the exception ofa single test which fails due to a changed API used by a helperscript. This commit updates the helper script to use the newAPIs and marks the `hghooks` extension as compatible with5.0.Depends on D33848Differential Revision: https://phabricator.services.mozilla.com/.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=df232910b213 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=df232910b213)|2019-06-06 13:27:26
|12|Connor Sheehan |hgtemplates: run `test-template-sync.t` against Mercurial 5.0.1 ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globThis version should always match the version running on hg.mo,which means it needs to be bumped during the upgrade. Runningthis test should tell us if we have any outstanding templateupgrades to perform, and since it passes without issue, wedon't need to make any template changes.Depends on D33849Differential Revis.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4b32cf190f59 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4b32cf190f59)|2019-06-06 13:27:26
|13|Connor Sheehan |hg50: mark many extensions as compatible with Mercurial 5.0 ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globNo changes needed to get these extensions passing under 5.0.Depends on D33850Differential Revision: https://phabricator.services.mozilla.com/D33851|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=25a0f6ca4c3b)|2019-06-06 13:27:26
|14|Connor Sheehan |ansible/hg-ssh: upgrade to Mercurial 5.0.1 ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globThis commit upgrades Mercurial to 5.0.1 on hgssh in allvirtual environments. This commit should be deployed firstin the upgrade process.Depends on D33852Differential Revision: https://phabricator.services.mozilla.com/D33853|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=55f71016659c)|2019-06-06 13:27:26
|15|Connor Sheehan |ansible/hg-web: upgrade to Mercurial 5.0.1 ( [Bug 1557070](https://bugzilla.mozilla.org/show_bug.cgi?id=1557070)  ) r=globThis commit upgrades Mercurial to 5.0.1 in all virtual environmentson hgweb.Depends on D33853Differential Revision: https://phabricator.services.mozilla.com/D33855|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=cd14589c8543)|2019-06-06 13:27:26
|16|Connor Sheehan |hgext: remove `wireprotocache` extension ( [Bug 1557143](https://bugzilla.mozilla.org/show_bug.cgi?id=1557143)  ) r=globThis extension was to be used as a caching module for wire protocolversion two command responses, in a similar fashion to the cachinglayer used in front of remotefilelog. With the wire protocol workon hold indefinitely, we can remove this half-completed extension.Differential Revision: https://phabricator.services.mozilla.com/D33864|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=06c086758a98)|2019-06-06 13:26:21
|17|Connor Sheehan |pushlog: fix tests regressed by 8edc6d00a988Simply adds the new CSS classes to the test output,and adds a new patch file to the `hgtemplates/.patches`directory.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b03eb039bfcc)|2019-06-05 21:52:17
|18|Connor Sheehan |TICKscript: fix time unit in `try_heads.tick` ( [Bug 1556530](https://bugzilla.mozilla.org/show_bug.cgi?id=1556530)  )Also fix the variable name for the alert node.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0c3c8497e990)|2019-06-05 15:25:48
|19|Connor Sheehan |telegraf: change `1d` to `24h` ( [Bug 1555777](https://bugzilla.mozilla.org/show_bug.cgi?id=1555777)  )Telegraf supports `ns`, `us`, `ms`, `s`, `m` and `h`as units of time - no `d` allowed.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=da1cce9dc5ca)|2019-06-05 14:59:43
|20|Connor Sheehan |hgwsgi: add `mozilla-esr68` ( [Bug 1555777](https://bugzilla.mozilla.org/show_bug.cgi?id=1555777)  ) r=globThe repo was cloned and replicated earlier today, this commitmakes the repo available on hgmo.Differential Revision: https://phabricator.services.mozilla.com/D33371|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=21c2d28dc20d)|2019-06-05 13:50:34
|21|Connor Sheehan |ansible/hg-ssh: generate bundles for mozilla-esr68 ( [Bug 1555777](https://bugzilla.mozilla.org/show_bug.cgi?id=1555777)  ) r=globSo we can clone the new ESR fast in automation and elsewhere.Depends on D33371Differential Revision: https://phabricator.services.mozilla.com/D33372|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=21ad1659be41)|2019-06-05 13:50:34
|22|Connor Sheehan |ansible/hg-ssh: add esr68 to mozilla-unified ( [Bug 1555777](https://bugzilla.mozilla.org/show_bug.cgi?id=1555777)  ) r=globUnified includes all relevant commits in various Firefoxrepositories, and thus should include ESR68.Depends on D33372Differential Revision: https://phabricator.services.mozilla.com/D33373|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3c7eb39555a5)|2019-06-05 13:50:34
|23|Connor Sheehan |mozautomation: add ESR68 ( [Bug 1555777](https://bugzilla.mozilla.org/show_bug.cgi?id=1555777)  ) r=globThis commit adds ESR68 to all the required locationsin `mozautomation`.Depends on D33373Differential Revision: https://phabricator.services.mozilla.com/D33374|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1852d1d7a0d5)|2019-06-05 13:50:34
|24|Connor Sheehan |ansible/hg-web: add esr68 to `replicationrules` and remove esr52 ( [Bug 1555777](https://bugzilla.mozilla.org/show_bug.cgi?id=1555777)  ) r=globWe will need to have a copy of ESR68 on the mirrors, and thusit need to be added to the mirror replication rules. ESR52 hasreached EOL, so it has been removed.Differential Revision: https://phabricator.services.mozilla.com/D33375|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=79d8b8bd4bd5)|2019-06-05 13:50:34
|25|Connor Sheehan |telegraf: add an `exec` plugin to report the number of heads on try ( [Bug 1556530](https://bugzilla.mozilla.org/show_bug.cgi?id=1556530)  ) r=globThis commit adds a Telegraf `exec` input plugin to monitor thenumber of heads on the try repo on hgssh. The command is a callto `hg log`, taking a call to the `revset` template function andpassing it through the `count` template filter to get the numberof revisions in the specified revset ( in this case, `head( ).. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3ae4efdfac68 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3ae4efdfac68)|2019-06-05 13:50:05
|26|Connor Sheehan |TICKscripts: add alert for too many try heads ( [Bug 1556530](https://bugzilla.mozilla.org/show_bug.cgi?id=1556530)  ) r=globIn the previous commit we added reporting for the number ofheads on try, and in this commit we tell Kapacitor to send aSlack alert in the event we cross 40000/50000 heads ( as a warningand critical alert, respectively ). This script is checked in toversion-control-tools with the other alerting scripts for trackingpurposes but will nee.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b793a0142828 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b793a0142828)|2019-06-05 13:50:05
|27|Tom Prince |No bug: Show relative time for push date on `/rev/`; r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D33366|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8edc6d00a988)|2019-06-03 16:48:07
|28|Connor Sheehan |ansible: remove `ci-{ec1,ue2}` hostgroups ( [Bug 1553885](https://bugzilla.mozilla.org/show_bug.cgi?id=1553885)  )These have been torn down.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d12b6b56fec5)|2019-05-28 16:56:15
|29|Connor Sheehan |hghooks: update `test-prevent-webidl-changes.t` ( [Bug 1554853](https://bugzilla.mozilla.org/show_bug.cgi?id=1554853)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=04fd22c76ae7)|2019-05-28 14:54:00
|30|Peter Van der Beken |[Bug 1554853](https://bugzilla.mozilla.org/show_bug.cgi?id=1554853)  - Update DOM peers list in prevent_webidl_changes.py. r=sheehan?Differential Revision: https://phabricator.services.mozilla.com/D32797|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3c51465f9f92)|2019-05-28 14:48:22
|31|Connor Sheehan |terraform: tear down AWS resources in `eu-central-1` and `us-east-2` ( [Bug 1553885](https://bugzilla.mozilla.org/show_bug.cgi?id=1553885)  ) r=dustinWhile these regions have a Gecko workers VPC available,it appears there are no workers configured to run in them.In this commit we tear down the hgmo VPC in the same regions.We can easily stand up the VPCs again if we set up workers inthose regions.Differential Revision: https://phabricator.services.mozilla... [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=dfdbe16c8faa )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=dfdbe16c8faa)|2019-05-27 17:48:51
|32|Connor Sheehan |TICKscripts: update alerts and add alerting for KafkaHere we add alerting for the absence of Kafka processes onour broker hosts, change the alerts to only fire on statechanges every 2 minutes, and bold some of the text in thealert message.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d99210e8b88f)|2019-05-27 17:46:01
|33|Connor Sheehan |ansible/hg-web: add cedar project repo to `replicationrules` ( [Bug 1554307](https://bugzilla.mozilla.org/show_bug.cgi?id=1554307)  )I noticed this was missing when Kapacitor started firing offconsumer lag alerts, but only for the on-premises nodes.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=af4e16b5aa36)|2019-05-24 20:34:04
|34|Connor Sheehan |TICKscripts: alert on state changes only with 2 minute windowCurrently the TICKscript alerts continuously fire every timea new data point reaches Kapacitor. With this change the alertswill only go off once, then wait for 2 minutes before firingagain if the alert is in the same state. All state changes( ie warning -> critical or anything -> OK ) will still fire analert.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=20fc9edb1c22)|2019-05-24 20:34:04
|35|Connor Sheehan |ansible/hg-web: remove filter for sheehan's user repo ( [Bug 1553319](https://bugzilla.mozilla.org/show_bug.cgi?id=1553319)  )Left over from development/testing.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=fb153bf90ccb)|2019-05-22 15:02:49
|36|Connor Sheehan |ansible/hg-web: add Thunderbird release repos to replication filters ( [Bug 1553323](https://bugzilla.mozilla.org/show_bug.cgi?id=1553323)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b85b908567bf)|2019-05-22 15:02:49
|37|Connor Sheehan |TICKscripts: increase thresholds in `vcsreplicator_consumer_lag.tick`The Slack alerts were happening too frequently to be actionable.Here we increase the thresholds to a level high enough that analert should require action.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0a3096a899ce)|2019-05-17 14:51:23
|38|Connor Sheehan |ansible: declare `ansible_{sudo,become}` as hostgroup variables|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=eedbbe051557)|2019-05-15 17:08:31
|39|Connor Sheehan |ansible: move eu-central-1 hosts to hgweb-mirrors hostgroup|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=fdb441baf69a)|2019-05-15 17:08:31
|40|Connor Sheehan |ansible/hg-ssh: add `autoland` to mozilla-unified ( [Bug 1551274](https://bugzilla.mozilla.org/show_bug.cgi?id=1551274)  ) r=smacleodThis commit adds the `autoland` repository to the set of repositoriesin mozilla-unified. The tip revision of this repository will havea bookmark named `autoland` at it's tip revision, copying the sectionname in the config file. Since all new commits will be on the defaultbranch, we limit the pulled revisions to that branch.D.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=57918871a6c0 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=57918871a6c0)|2019-05-15 16:49:16
|41|Connor Sheehan |ansible: use correct IPs for eu-central-1 hosts ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )My merge went awry and the hosts weren't updated. This commitsets the IPs to the correct value.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c1c4a668367b)|2019-05-14 20:49:59
|42|Connor Sheehan |ansible: fix `bootstrap_hostname` for eu-central-1 mirrors ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c72925f6b17c)|2019-05-14 20:31:44
|43|Connor Sheehan |ansible/hg-ssh-server: add `sentry-sdk` to `venv_pash` ( [Bug 1550755](https://bugzilla.mozilla.org/show_bug.cgi?id=1550755)  ) r=larsThis commit adds `sentry-sdk` to the pash virtualenvon the hgssh servers.Differential Revision: https://phabricator.services.mozilla.com/D30654|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d18e8a095ea4)|2019-05-14 16:05:20
|44|Connor Sheehan |terraform: stand up private hg service in us-east-2 ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e3dce3f0d26a)|2019-05-14 14:31:56
|45|Connor Sheehan |ansible: move us-east-1 hosts to hgweb-mirrors hostgroup and us-east-2 hosts to bootstrap group ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=cbfd7f665c0f)|2019-05-14 14:31:56
|46|Connor Sheehan |ansible: split `hgweb-mirrors` into regional subgroups ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )Previously we had a single group with comments denotingthe different regions. Now we can reference hosts in theindividual regions by their hostgroup. This will allow usto use Ansible to run commands on machines in various AWSregions with ease.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0bf07df77731)|2019-05-14 14:31:56
|47|Connor Sheehan |bootstrap: run `hg replicatehgrc` for try repos on correct host ( [Bug 1550782](https://bugzilla.mozilla.org/show_bug.cgi?id=1550782)  )This command was being run on the new hgweb machine, insteadof the hgssh master host. Oops!|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=64b81e9c817b)|2019-05-14 14:31:56
|48|Connor Sheehan |ansible: move newly bootstrapped hosts in `ci-ue2` hostgroup ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4c5a2e4076a4)|2019-05-14 14:31:56
|49|Connor Sheehan |terraform: stand up private hg service in eu-central-1 ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4588772ce1ae)|2019-05-14 14:31:56
|50|Connor Sheehan |terraform: add AMI ID for CentOS7 in eu-central-1 ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )The CentOS7 AMI ID for eu-central-1 was never added to theregional mapping. This commit adds the new region andre-formats the whitespace.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=09eac4fb3815)|2019-05-14 14:31:56
|51|Connor Sheehan |bootstrap: add us-east-2 hosts to bootstrap hostgroup ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=ccc7fbade54f)|2019-05-14 14:31:56
|52|Connor Sheehan |bootstrap: fix file permissions on `instance_data.json` during bootstrap ( [Bug 1550782](https://bugzilla.mozilla.org/show_bug.cgi?id=1550782)  )Something in the bootstrap procedure sets ownership of thisfile from `hg:hg` to `1001:1002` during the bootstrapplaybook. Here we reset the permissions to the desiredstate once bootstrapping is complete.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=663cd30b7a27)|2019-05-14 14:31:56
|53|Connor Sheehan |terraform: do not create new ec2 resource when `user_data` changesChanges to user data shouldn't create a new resource. Anyuser data changes will be manually applied to the extra mirrorsas needed.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=13f70d71ae3a)|2019-05-13 17:36:05
|54|Connor Sheehan |terraform: stand up private hg service in us-east-1 ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=ca6924b0110d)|2019-05-13 17:36:05
|55|Connor Sheehan |ansible: add us-east-1 hosts to bootstrap hostgroup ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c5cdceaf4de3)|2019-05-13 17:36:05
|56|Connor Sheehan |ansible/bootstrap: set hostname based on hostgroup variable during bootstrap|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=91edbf180dfb)|2019-05-13 17:36:05
|57|K Lars Lohn |hgext: update deprecated call to ui.progress ( [Bug 1550175](https://bugzilla.mozilla.org/show_bug.cgi?id=1550175)  ) r=sheehanFor the extension `overlay`, the call to `ui.progress` was just replaced`ui.makeprogress`. This is justified by the declaration in `overlay`requiring HG47 or later. Since `ui.makeprogress` was introduced in HG47,this seem justified.For the extension `mozext`, since I know nothing of what versions ofHG will be used, a local funct.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=342896d12d09 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=342896d12d09)|2019-05-10 18:48:11
|58|Connor Sheehan |ansible: add new hosts in `us-west-1` to `hgweb-mirrors` hostgroup ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )These have been bootstrapped and are serving production traffic.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=858555769242)|2019-05-10 16:39:32
|59|Connor Sheehan |ansible/bootstrap: turn off Telegraf during bootstrap procedure ( [Bug 1550777](https://bugzilla.mozilla.org/show_bug.cgi?id=1550777)  )Keeping the agent on causes lots of unnecessary alerts inthe #vcs Slack channel.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1fa8a029c136)|2019-05-10 16:39:32
|60|Connor Sheehan |ansible/bootstrap: run `hg replicatehgrc` on try repos after running a stream clone ( [Bug 1545387](https://bugzilla.mozilla.org/show_bug.cgi?id=1545387)  )See [Bug 1545387](https://bugzilla.mozilla.org/show_bug.cgi?id=1545387)  comment 7 for more on why we need this change.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f98ead5d399d)|2019-05-10 16:39:32
|61|Connor Sheehan |terraform: run `chown` recursively on full `/var/hg` directory instead of `instance_data.json` ( [Bug 1550782](https://bugzilla.mozilla.org/show_bug.cgi?id=1550782)  )Previously we only ran `chown` on the instance data object,leaving `/var/hg` owned by `root`. Then when Ansible overwritesthe permissions to make `hg` the owner, the instance dataobject has it's permissions corrupted.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3a3df759c32c)|2019-05-10 16:39:32
|62|Connor Sheehan |terraform: upgrade mirror instances to `c5d.2xlarge`The instances were previously set to this type, but Imoved them down as they could handle the traffic.Unfortunately when project repos like `larch` or `maple`need to pull, the increased amount of CPU required tocalculate the response multiplied by the number ofresponses that must be generated create too much load.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=6e41162eed29)|2019-05-09 15:02:15
|63|Connor Sheehan |terraform: set `ebs_optimized = true` for hgweb mirrors|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=6cd9df449844)|2019-05-09 15:02:15
|64|Connor Sheehan |ansible: update bootstrap hostsTerraform changes required me to re-create the machines.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=33aa6d00f3c3)|2019-05-09 15:02:15
|65|Connor Sheehan |ansible/hg-ssh-server: do not install `ldap_helper.py` in pash setup ( [Bug 1547755](https://bugzilla.mozilla.org/show_bug.cgi?id=1547755)  )Doing so causes install to fail, when it is available in thepash virtualenv from hgmolib.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=60e5485f114b)|2019-05-09 13:54:32
|66|Connor Sheehan |ansible: add new hosts to bootstrap hostgroup ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e63c96151e7d)|2019-05-08 18:19:02
|67|K Lars Lohn |pash: Move ldap_helper from pash to hgmolib ( [Bug 1547755](https://bugzilla.mozilla.org/show_bug.cgi?id=1547755)  ) r=sheehanThis allows using the LDAP module in code other than just pash.Differential Revision: https://phabricator.services.mozilla.com/D30379|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=aa66da08bd4d)|2019-05-08 17:52:40
|68|Connor Sheehan |terraform: add "to-mdc" search term in `aws_vpn_gateway` data source ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  ) r=bstackPreviously we searched for "to-mdc's". The new gateway onlylinks back to one of the datacentres, so keeping the name whileselecting the correct connection seems like the correct way tohandle this.Differential Revision: https://phabricator.services.mozilla.com/D30292|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f250d8415b45)|2019-05-08 17:35:55
|69|Connor Sheehan |terraform: remove subnets in availability zone C ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  ) r=bstackTurns out, us-west-1 doesn't have an availability zone C. Thiswas mentioned to me during review, and I thought I checked eachregion to ensure there was a third AZ for each, but apparentlythe way I checked was wrong. Oops!Considering we aren't using the subnet in that AZ at the momentany way, this isn't a huge deal. So this comm.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4172e809ba0e )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4172e809ba0e)|2019-05-08 17:35:55
|70|Connor Sheehan |terraform: remove security group rule allowing Telegraf traffic from MDC1 ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  ) r=bstackThis rule was previously in place to allow our on-premises hoststo send data to the test InfluxDB instance. Now that we have theproduction service online, we can remove it.Differential Revision: https://phabricator.services.mozilla.com/D30294|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=19a3a9e03887)|2019-05-08 17:35:55
|71|Connor Sheehan |terraform: rename Route53 record variable to be region agnostic ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  ) r=bstackThe Terraform variable name included "uw2", short for"us-west-2". Now that we are deploying to more regions,it should be changed.Differential Revision: https://phabricator.services.mozilla.com/D30295|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=64e8e9a62933)|2019-05-08 17:35:55
|72|Connor Sheehan |terraform: create unique certificate per region ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  ) r=bstackThe previous plan was to create a single certificate that wouldbe shared across AWS regions, but we have since learned thatACM certificates are per-region only. So this commit moves thecertificate resource definition from the `main.tf` file for theentire Terraform config and into the `aws-vpc` modules for eachspecific AWS region.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c6ea6220b09d )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c6ea6220b09d)|2019-05-08 17:35:55
|73|Connor Sheehan |terraform: stand up AWS VPC environment in us-west-1 ( [Bug 1548302](https://bugzilla.mozilla.org/show_bug.cgi?id=1548302)  ) r=bstackNow that our environment is reproducible in different AWS regions,this commit creates a new instance of the `aws-vpc` modules for usein us-west-1.Differential Revision: https://phabricator.services.mozilla.com/D30297|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0ac1bb96d120)|2019-05-08 17:35:55
|74|Connor Sheehan |ansible/hg-ssh: track `pushdataaggregator_groups` file under version control ( [Bug 1549724](https://bugzilla.mozilla.org/show_bug.cgi?id=1549724)  ) r=larsThis file currently lives on the hgssh shared NFS mount, and isuntracked by version control.Differential Revision: https://phabricator.services.mozilla.com/D30221|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1e05f401fe4f)|2019-05-08 14:35:33
|75|Connor Sheehan |hg50: mark several extensions as compatible with Mercurial 5.0 ( [Bug 1545236](https://bugzilla.mozilla.org/show_bug.cgi?id=1545236)  ) r=larsThese extensions all pass under the release candidatewithout any test changes.Differential Revision: https://phabricator.services.mozilla.com/D28563|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=3e6170e6eced)|2019-05-08 14:17:32
|76|Connor Sheehan |serverlog: update number of bytes served in test output after 40-char SHA patch ( [Bug 1548149](https://bugzilla.mozilla.org/show_bug.cgi?id=1548149)  ) r=larsThe number of bytes served has changed after making hgmoserve the 40-character SHA by default. It's not a breakingchange, so it's not a huge deal, but I'm still investigatingthe cause.Differential Revision: https://phabricator.services.mozilla.com/D29443|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=72bf13cdc44e)|2019-05-07 16:15:15
|77|Connor Sheehan |ansible/monitoring-agent: remove `influxdb` test instance output module ( [Bug 1548865](https://bugzilla.mozilla.org/show_bug.cgi?id=1548865)  ) r=globThis commit makes the Telegraf reporting agent no longer sendoutput data to the test InfluxDB instance.Differential Revision: https://phabricator.services.mozilla.com/D29845|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=96ccae6376a2)|2019-05-06 17:11:52
|78|Connor Sheehan |ansible: remove `monitoring-host` role and move TICKscripts elsewhere ( [Bug 1548865](https://bugzilla.mozilla.org/show_bug.cgi?id=1548865)  ) r=globThis role was used to configure the test InfluxDB instance,which is no longer needed since the production service isavailable for use.The TICKscripts should still be tracked under versioncontrol, so I've moved them under the `scripts` directory.I'd like to find a way to automatically update the scriptsin Kapa.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8d6e7d5e183b )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8d6e7d5e183b)|2019-05-06 17:11:52
|79|Connor Sheehan |terraform: remove monitoring host from `aws-vpc` config ( [Bug 1548865](https://bugzilla.mozilla.org/show_bug.cgi?id=1548865)  ) r=bstackAll traffic is now being sent to the production instance, sowe no longer need this test machine.Differential Revision: https://phabricator.services.mozilla.com/D29847|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=70d5c046a40e)|2019-05-06 17:11:52
|80|Jed Davis |hghooks: update IPC peer list to add nika, remove former peers, and fix my name ( [Bug 1548966](https://bugzilla.mozilla.org/show_bug.cgi?id=1548966)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D29923|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7c70357a7182)|2019-05-06 14:53:04
|81|Connor Sheehan |obsolescencehacks: mark as compatible with Mercurial 4.9 ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  )Tests pass, we simply overlooked the compatible version bump.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1e8f278de369)|2019-05-06 14:10:31
|82|Connor Sheehan |ansible/monitoring-agent: add monitoring of Kafka/Zookeeper processes ( [Bug 1548266](https://bugzilla.mozilla.org/show_bug.cgi?id=1548266)  ) r=globWe'd like to add monitoring of our Kafka brokers to the`monitoring-agent` Ansible role. In this commit we createa new `kafka.conf.j2` template which will include allTelegraf plugins used to monitor Kafka, and include thetemplate in our Telegraf config on the condition theKafka host is in our `zk_servers` `hgm.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=222d1e4907cb )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=222d1e4907cb)|2019-05-06 13:44:20
|83|Connor Sheehan |hgtemplates: wrap instances of `author` template keyword with `mailmap` function ( [Bug 1464838](https://bugzilla.mozilla.org/show_bug.cgi?id=1464838)  ) r=globMercurial has an implementation of Git's `mailmap` available as atemplate function. I added the implementation as a way of easingmy way into learning the Mercurial codebase. This commit performsa regex replace of `{author` with `{mailmap( author )` everywherein `gitweb_mozilla`, and adds the associat.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=a91af8a784ee )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=a91af8a784ee)|2019-05-06 13:43:36
|84|Connor Sheehan |pushlog: fix tests regressed by 40-character node patch ( [Bug 1548054](https://bugzilla.mozilla.org/show_bug.cgi?id=1548054)  ) r=larsA few tests were overlooked when changing `gitweb_mozilla`to display 40-character SHAs. This commit fixes those tests.Differential Revision: https://phabricator.services.mozilla.com/D29397|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d9911e62f3a4)|2019-04-30 20:55:39
|85|Connor Sheehan |ansible/monitoring-agent: remove retention policy from database name ( [Bug 1543989](https://bugzilla.mozilla.org/show_bug.cgi?id=1543989)  )We only need the database name in this field.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2a93b060dd7e)|2019-04-30 17:39:20
|86|Connor Sheehan |ansible/monitoring-agent: remove quotes around boolean variable ( [Bug 1543989](https://bugzilla.mozilla.org/show_bug.cgi?id=1543989)  )This causes the variable to be a string instead of a bool.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f13310e10021)|2019-04-30 16:25:39
|87|Connor Sheehan |ansible/monitoring-agent: fix production InfluxDB credentials ( [Bug 1543989](https://bugzilla.mozilla.org/show_bug.cgi?id=1543989)  )The production URL for Mozilla's InfluxDB instance wasincorrect, as well as the database name being enclosedby too many quotes.The `influxdb_skip_database_creation` variable is alsoadded as `True` ( valid in Python ) instead of `true`( valid JSON/TOML ), so we add a `to_json` filter tothat variable.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d7b0532a4e6a)|2019-04-30 16:09:51
|88|Connor Sheehan |robustcheckout: remove arguments passed to `matchmod.always` in modern Mercurial ( [Bug 1546507](https://bugzilla.mozilla.org/show_bug.cgi?id=1546507)  ) r=globThe arguments passed to `matchmod.always` are unused under thehood, so they've been removed in Mercurial 5.0 and onward.Differential Revision: https://phabricator.services.mozilla.com/D29271|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=88247fb4308a)|2019-04-30 15:53:54
|89|Connor Sheehan |ansible/monitoring-agent: add encrypted InfluxDB credentials ( [Bug 1543989](https://bugzilla.mozilla.org/show_bug.cgi?id=1543989)  ) r=larsThis commit adds a set of default Ansible variables in the`monitoring-agent` role, for sending data to Mozilla'sproduction InfluxDB instance.Since `sops` doesn't yet know how to parse TOML, we storethe secrets as YAML Ansible defaults.Differential Revision: https://phabricator.services.mozilla.com/D28363|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=baa4bb1271e8)|2019-04-30 15:03:56
|90|Connor Sheehan |ansible/monitoring-agent: send monitoring data to production InfluxDB instance ( [Bug 1543989](https://bugzilla.mozilla.org/show_bug.cgi?id=1543989)  ) r=larsThis commit tells Telegraf to send data to the production InfluxDBinstance. At the moment we will send data to both the test instanceand the production instance, to verify all the data is correctlysent.Differential Revision: https://phabricator.services.mozilla.com/D28364|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=32df72677efb)|2019-04-30 15:03:56
|91|Connor Sheehan |hgtemplates: pass `node` through `short` template filter for `data-node` HTML tag ( [Bug 1547870](https://bugzilla.mozilla.org/show_bug.cgi?id=1547870)  ) r=globNot passing the node through `short` causes a `querySelector`call in `mercurial.js` to return nothing. This call is responsiblefor applying left padding to the element, to allow the graphto display without the changeset information on top.Differential Revision: https://phabricator.services.mozilla.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=41e63de62c96 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=41e63de62c96)|2019-04-30 15:00:40
|92|Connor Sheehan |mozhg: use renamed keyword argument when running under Mercurial >= 5.0 ( [Bug 1546508](https://bugzilla.mozilla.org/show_bug.cgi?id=1546508)  ) r=globUnder Mercurial 5.0, the `copied` keyword argument passedto `context.memfilectx` has been renamed to `copysource`.This commit adds a conditional to use the correct argumentname when running under the new version.Differential Revision: https://phabricator.services.mozilla.com/D29212|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=ae489559efe1)|2019-04-29 15:44:11
|93|Connor Sheehan |push-to-try: mark as compatible with Mercurial 5.0 ( [Bug 1546508](https://bugzilla.mozilla.org/show_bug.cgi?id=1546508)  ) r=globWith `mozhg` now compatible with the 5.0 release candidate,`push-to-try` tests pass under the new version.Differential Revision: https://phabricator.services.mozilla.com/D29213|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=db9bc20ab995)|2019-04-29 15:44:11
|94|Connor Sheehan |hgtemplates: do not pass `node` through `short` template filter anywhere ( [Bug 1539324](https://bugzilla.mozilla.org/show_bug.cgi?id=1539324)  ) r=globTreeherder has removed support for using 12 character revisionSHAs, due to the performance hit taken by being unable to fullyindex a 12 character SHA ( since the 40 character SHA is thecanonical version ). This commit performs a global replace of`{node|short}` with `{node}` for the `gitweb_mozilla` theme.The.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=51905dc214c4 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=51905dc214c4)|2019-04-29 13:50:05
|95|Connor Sheehan |hgserver: add `sparserevlog` capability to `test-obsolescence-server.t` ( [Bug 1547276](https://bugzilla.mozilla.org/show_bug.cgi?id=1547276)  )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0ec322c77f23)|2019-04-26 15:21:03
|96|Connor Sheehan |hgserver: add `sparserevlog` bundle requirement to `test-clonebundles.t` ( [Bug 1547276](https://bugzilla.mozilla.org/show_bug.cgi?id=1547276)  )New bundles under 4.9.1 include the `sparserevlog` requirement.Since none of the repos on hgmo are in the `sparserevlog` formatyet, this is just extra test output we need to add. It doesn'taffect behaviour in any way.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=58286127f121)|2019-04-26 15:21:03
|97|Connor Sheehan |hgserver: add `reposetup` timing output to `test-push-basic.t` blackbox logs ( [Bug 1547276](https://bugzilla.mozilla.org/show_bug.cgi?id=1547276)  )Mercurial 4.9.1 now includes repo setup timing information inblackbox logs, which we have yet to add to the tests.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e8a3e082d629)|2019-04-26 15:21:03
|98|Connor Sheehan |ansible/monitoring-agent: only modify httpd access log permissions when `hosttype` is "hgweb"hgssh doesn't install Apache, so there's no log to modify.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=210ad037e038)|2019-04-24 15:04:18
|99|Connor Sheehan |ansible/monitoring-agent: use `elif` instead of `else` in Jinja2 templateAlso use double quotes to indicate a string.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=bdc17e270d0b)|2019-04-23 20:22:41
|100|Connor Sheehan |terraform: allow MDC1 hosts to send traffic to InfluxDB test instance ( [Bug 1545434](https://bugzilla.mozilla.org/show_bug.cgi?id=1545434)  )Forgot to add these new hosts to the security group rule.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=a9512159265c)|2019-04-23 19:38:14
|101|Connor Sheehan |ansible/monitoring-agent: move `hgweb` specific components behind a variable ( [Bug 1545434](https://bugzilla.mozilla.org/show_bug.cgi?id=1545434)  ) r=smacleodThis way we can deploy our Telegraf config to hgssh,and monitor host-specific things ( such as aggregatorlag on hgssh, consumer lag on hgweb, etc ).Differential Revision: https://phabricator.services.mozilla.com/D28150|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=fae277edab13)|2019-04-23 19:28:01
|102|Connor Sheehan |vcsreplicator: add `--telegraf` flag to aggregator lag check ( [Bug 1545434](https://bugzilla.mozilla.org/show_bug.cgi?id=1545434)  ) r=smacleodThis commit adds a `--telegraf` flag to the aggregator lag checkscript running on hgssh. When the script is run with this flag,the output will be formatted as JSON, consumable by Telegraf's`exec` plugin. With this flag added, we will be able to sendaggregator lag data to InfluxDB for monitoring/alerting purposes.D.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7853f082ab09 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7853f082ab09)|2019-04-23 19:28:01
|103|Connor Sheehan |ansible/monitoring-agent: add `hgssh` specific plugins to Telegraf config ( [Bug 1545434](https://bugzilla.mozilla.org/show_bug.cgi?id=1545434)  ) r=smacleodThis commit adds a `hgssh` specific set of configuration optionsto the Telegraf configuration file. At the moment we track thelag of the "aggregator" replication daemons, and the presenceof processes for those daemons. We also apply the `monitoring-agent`role in the hgssh deploy playbook and set `hgss.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8644eae3410c )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8644eae3410c)|2019-04-23 19:28:01
|104|Connor Sheehan |terraform: remove `hgmointernal.com` Route53 private hosted zoneWe switched to a public hosted zone instead, so the privatezone is no longer needed.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=675b07956340)|2019-04-23 19:26:29
|105|Connor Sheehan |testing: run template sync test against Mercurial 4.9.14.9.1 is the version we have on the server, and thereforethe version we should run this test against. I've also addeda comment saying this number should always match our currentserver version.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7a33c0d1d60b)|2019-04-18 21:42:16
|106|Connor Sheehan |vcsreplicator: add a test demonstrating pull behaviour on hgssh ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsIn attempting to fix `test-pushkey-obsolescence.t` to makevcsreplicator compatible with Mercurial 4.9, I needed to allowserving the `unfiltered` repoview on hgssh. This had thepotential to change the behaviour of pulls against the sshendpoint on hgmo, so to ensure we don't change the intendedbehaviour by accident, .. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e21d785cb133 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e21d785cb133)|2019-04-17 16:13:30
|107|Connor Sheehan |vcsreplicator: remove test output conditional on unsupported Mercurials ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsWe still have quite a few `( hg4X ! )` conditional output in testsfor versions that are not 4.8 or 4.9. In this commit, we cleanup our tests by removing the unnecessary conditionals.Differential Revision: https://phabricator.services.mozilla.com/D27779|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=9a114f7abf94)|2019-04-17 16:13:30
|108|Connor Sheehan |vcsreplicator: serve the unfiltered repoview on hgssh ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsThis commit patches the hgssh vcsreplicator Mercurial extension toserve the `unfiltered` repoview for pull operations performed bythe `unfiltereduser`. This fixes failures where consumers wereunable to process `changegroup` messages that referenced now-obsoletechangesets on hgssh. After this patch, the `vcs-sync` user is alw.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2deacafd9abb )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2deacafd9abb)|2019-04-17 16:13:30
|109|Connor Sheehan |ansible/hg-web: upgrade Mercurial to 4.9.1 ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsIn this commit we upgrade all hgweb Mercurial installations toversion 4.9.1.Differential Revision: https://phabricator.services.mozilla.com/D27924|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8fdb71a76345)|2019-04-17 16:13:30
|110|Connor Sheehan |ansible/hg-ssh: upgrade Mercurial to 4.9.1 ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsIn this commit we upgrade all hgssh Mercurial installations toversion 4.9.1.Differential Revision: https://phabricator.services.mozilla.com/D27925|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d4167b373314)|2019-04-17 16:13:30
|111|Connor Sheehan |mozhg: fix `test-rewrite.t` ( [Bug 1544838](https://bugzilla.mozilla.org/show_bug.cgi?id=1544838)  ) r=larsThis commit adds a new line of test output to`test-rewrite.t`, conditional on Mercurial 4.7 orlater.Differential Revision: https://phabricator.services.mozilla.com/D27815|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=9d8dd59d9bac)|2019-04-17 14:45:52
|112|Connor Sheehan |ansible: turn off services irrelevant to hgweb mirrors during deploy ( [Bug 1511058](https://bugzilla.mozilla.org/show_bug.cgi?id=1511058)  ) r=globWe don't need to serve traffic to Mozilla officesfrom the private hgmo service, so we can turn offthe IP address scraper service.In the future we should refactor the hgweb roleto do this automatically ( ie not install an unnecessaryservice in the first place ).Differential Revision: https://phabricator.services... [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c3c46a4fa5bf )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c3c46a4fa5bf)|2019-04-15 13:54:12
|113|Connor Sheehan |ansible: make hostgroups variable in hgweb/mirrors deploy playbooks ( [Bug 1511058](https://bugzilla.mozilla.org/show_bug.cgi?id=1511058)  ) r=globBy making the hostgroups variable, we can set variables onthe playbook "includes" that change which hostgroup the playis deployed to. This is useful to deploy the hgweb role andother tasks to hosts in the `bootstrap` group.Differential Revision: https://phabricator.services.mozilla.com/D26991|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1caf95de12c0)|2019-04-15 13:54:12
|114|Connor Sheehan |ansible: fix bootstrap and teach it to apply `hg-web` role ( [Bug 1511058](https://bugzilla.mozilla.org/show_bug.cgi?id=1511058)  ) r=globThere were a few subtle bugs with the hgweb bootstrapplaybook, including the fact that it assumed the hg-webrole was already applied. This commit adds code tooptionally apply hgweb/mirror playbooks on the existanceof an appropriate variable. The directory of the`hgssh.json` file is changed to the `hg` users home.We set .. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0670903b02ed )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0670903b02ed)|2019-04-15 13:54:12
|115|Connor Sheehan |ansible: make the number of concurrent clones variable ( [Bug 1511058](https://bugzilla.mozilla.org/show_bug.cgi?id=1511058)  ) r=globPreviously we had hard coded 5/8 as the number of concurrentworkers for the bootstrap processes. Making these variablewill allow us to scale up/down the number of workers asneeded for mirrors.Differential Revision: https://phabricator.services.mozilla.com/D26993|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=c3ad5a07b5fc)|2019-04-15 13:54:12
|116|Connor Sheehan |ansible: document new variables in bootstrap Ansible playbook ( [Bug 1511058](https://bugzilla.mozilla.org/show_bug.cgi?id=1511058)  ) r=globA small description of how to use the playbook at the top,as we do with most other Ansible playbooks.Differential Revision: https://phabricator.services.mozilla.com/D26994|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=59aedaf8f7f6)|2019-04-15 13:54:12
|117|Connor Sheehan |ansible: add new hgweb mirrors to `hgweb-mirrors` hostgroup ( [Bug 1511058](https://bugzilla.mozilla.org/show_bug.cgi?id=1511058)  ) r=globThese are the new IPs for the mirrors in us-west-2.Differential Revision: https://phabricator.services.mozilla.com/D26995|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0dfd8f1e780b)|2019-04-15 13:54:12
|118|Andi-Bogdan Postelnicu |configwizard: Disable 'format-source' extension since it served it's purpose. ( [Bug 1543645](https://bugzilla.mozilla.org/show_bug.cgi?id=1543645)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D27050|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=699240458208)|2019-04-12 13:03:23
|119|K Lars Lohn |vcsreplicator: update test, correcting order of expected output ( [Bug 1543448](https://bugzilla.mozilla.org/show_bug.cgi?id=1543448)  ) r=sheehanMachines of differing speeds produce the output of the test,test-consumer-daemon-restart.t, in a differing orders. Thischange synchronizes the output by adding a consumerwith "--wait-for-no-lag". This causes a pause that allows thetests that run subsequently to always have the same orderof expected output.The fo.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7951e7b5e7bf )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7951e7b5e7bf)|2019-04-11 17:41:39
|120|K Lars Lohn |vcsreplicator: simplify shutdown signal handlers ( [Bug 1543450](https://bugzilla.mozilla.org/show_bug.cgi?id=1543450)  ) r=sheehanThe existing shutdown signal handler fails to take into account the EINTRexception raised by blocking system calls. This is raised when the signalis caught during a system call like reading from a socket by Kafka. Thishappens when the signal handler simply returns without raising an exceptionof its own. The exsting handler .. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=a99aa3f3fd35 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=a99aa3f3fd35)|2019-04-11 17:37:19
|121|Connor Sheehan |terraform: rename `ci-only` module to `aws-vpc` ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackWhen I originally created the Terraform configs for the hgmoAWS account, our design goals were to isolate all resourcesfor the private hgweb mirrors into their own VPC. Afterworking towards productionizing these resources over thelast few months, I decided it makes more sense to havea single VPC for all hg related resources in t.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1340d12236b1 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1340d12236b1)|2019-04-10 21:36:31
|122|Connor Sheehan |terraform: make hgweb mirror instances variable ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackCurrently we only have a single hgweb mirror stood up,with the instance type of that mirror hard coded into it's Terraform module. This commit makes the instancetype a variable so we can add/reduce the compute powerif necessary.Differential Revision: https://phabricator.services.mozilla.com/D26977|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=51b1d5add43c)|2019-04-10 21:36:31
|123|Connor Sheehan |terraform: remove `environment_users` variable ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackWe were going to use this to create new users as partof our user data input. We've switch to a hard-codedcloud config for now, so this is safe to remove.Differential Revision: https://phabricator.services.mozilla.com/D26978|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8219a59625be)|2019-04-10 21:36:31
|124|Connor Sheehan |terraform: upgrade InfluxDB instance to `c4.2xlarge` ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackThis is only temporary while I work on redirecting ourInflux data to Mozilla's production instance.Differential Revision: https://phabricator.services.mozilla.com/D26979|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2755b890648b)|2019-04-10 21:36:31
|125|Connor Sheehan |terraform: move ELB target group attachment into the `hgweb-mirror` module ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackWe will need one attachment per instance - rather than create newattachments each time, let's just add the attachment to the moduleitself.Differential Revision: https://phabricator.services.mozilla.com/D26980|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0c9bfcf4a389)|2019-04-10 21:36:31
|126|Connor Sheehan |terraform: create new hgweb mirror host ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackThis host will be 1 of 2 attached to the internal loadbalancer.Differential Revision: https://phabricator.services.mozilla.com/D26981|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=36c8c075447e)|2019-04-10 21:36:31
|127|Connor Sheehan |terraform: rename `test-hgweb-mirror` to `hgweb-a` ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackSame code, but a new instance in AWS.Differential Revision: https://phabricator.services.mozilla.com/D26982|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b0dedd649093)|2019-04-10 21:36:31
|128|Connor Sheehan |terraform: increase disk space to 150GB on hgweb mirrors ( [Bug 1509039](https://bugzilla.mozilla.org/show_bug.cgi?id=1509039)  ) r=bstackWe were hitting the edge at 100GB.Differential Revision: https://phabricator.services.mozilla.com/D26983|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0ed956b29df0)|2019-04-10 21:36:31
|129|Sylvestre Ledru |hgext: clang-format hg hook: Ignore unsupported extensions directly in the hook ( [Bug 1542632](https://bugzilla.mozilla.org/show_bug.cgi?id=1542632)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D26446|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0c95e8341526)|2019-04-08 17:14:01
|130|Connor Sheehan |configwizard: remove warning about experimental status of `evolve` extension ( [Bug 1541887](https://bugzilla.mozilla.org/show_bug.cgi?id=1541887)  ) r=glob`evolve` is stable enough that we recommend it to developersworking on Firefox repos. The warning about it's "experimental"status is confusing and is likely driving people away fromadopting it for their workflow. This commit removes the warningand indicates that installation of `evolve` is desirable. W.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=77705a8ba4f5 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=77705a8ba4f5)|2019-04-05 14:05:36
|131|K Lars Lohn |hg49: make vcsreplicator/tests compatible ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehan1 - tests that list the .hg need to have some additonal files that are seen when using hg49 ( .../test-hgrc-replicate.t )2 - tests that depend on the contents of the .../mozilla-central/.hg/requires file need to have an additional line when using hg49Differential Revision: https://phabricator.services.mozilla.com/D26210|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=75145f5864c4)|2019-04-04 17:49:04
|132|Connor Sheehan |hghooks: make hooks compatible with Mercurial 4.9 ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsHere we make the hooks tests pass under Mercurial 4.9. A newlog statement was added during the `reposetup` stage ofextension loading, which is seen in the test output.Many `( ? )` statements are removed and replaced with inlineversion checks.Differential Revision: https://phabricator.services.mozilla.com/D25956|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=71545cbde3e6)|2019-04-03 20:01:15
|133|K Lars Lohn |hg49: hgext/firefoxreleases ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D25966|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=28f1a8fade1c)|2019-04-03 19:59:17
|134|K Lars Lohn |hg49: hgext/pushlog ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehanadded new "cache" and "wcache" present only in hg49removed 2 "#if h42" blocks because we're not using versions older than 4.8tagged 2 "--config" lines as not appearing when using hg49Differential Revision: https://phabricator.services.mozilla.com/D25967|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2046b5bf6072)|2019-04-03 19:59:17
|135|K Lars Lohn |hg49: hgext/readonly ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D25968|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2b23ebba2fb5)|2019-04-03 19:59:17
|136|K Lars Lohn |hg49: hgext/replicateowner ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D25969|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f498a35dc46e)|2019-04-03 19:59:17
|137|K Lars Lohn |hg49: hgext/serverlog ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D25970|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=d4aecc778e9f)|2019-04-03 19:59:17
|138|K Lars Lohn |hg49: hgext/unifyrepo ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D25971|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=db170e81bb17)|2019-04-03 19:59:17
|139|Connor Sheehan |hgmo: make compatible with Mercurial 4.9 ( [Bug 1513273](https://bugzilla.mozilla.org/show_bug.cgi?id=1513273)  ) r=larsTest extension works as intended under 4.9, with a fewminor additions to tests. A new cache file `wcache` hasbeen added as a virtual file system cache for filesrelated to the working copy. The UNIX-like exec flagcheck caches are no longer shown when displaying thecaches available on the local repository as the codepath that created them .. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=32f607700768 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=32f607700768)|2019-04-03 18:37:31
|140|Connor Sheehan |py3: global replace `repo['` with `repo[b'` ( [Bug 1541166](https://bugzilla.mozilla.org/show_bug.cgi?id=1541166)  ) r=larsUsing `__getitem__` on classes that subclass `repository` ( suchas `localrepository` ) results in Python 3 compatibility failuressince we are currently not marking our strings with `b''`. Thiscommit does a global replace to assert all strings passed as suchare byte strings.Differential Revision: https://phabricator.services.mozilla.com/.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f1043f9d2312 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f1043f9d2312)|2019-04-03 16:33:13
|141|Connor Sheehan |py3: remove Python 3 incompatible calls to `execfile` ( [Bug 1541166](https://bugzilla.mozilla.org/show_bug.cgi?id=1541166)  ) r=larsThis commit replaces all calls to `execfile` with a fileread and call to `exec`, with file content as the parameter.Differential Revision: https://phabricator.services.mozilla.com/D25849|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2c7002f9e788)|2019-04-02 20:41:03
|142|K Lars Lohn |Python2/Python3 compatibility - try/except form for pylib/mercurial-support/killdaemons.py ( [Bug 1541166](https://bugzilla.mozilla.org/show_bug.cgi?id=1541166)  ) r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D25850|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=13daf68f9066)|2019-04-02 20:29:11
|143|Connor Sheehan |hgext: mark several extensions as incompatible with legacy Mercurial ( [Bug 1539585](https://bugzilla.mozilla.org/show_bug.cgi?id=1539585)  ) r=larsEach of the following extensions has tests failing underolder versions of Mercurial, due to dependencies on the`hgmo` extension, which is only compatible with Mercurial4.8:- firefoxreleases- pushlog- unifyrepo- hghooks extensionConsidering all of these extensions run on the server,on which we currently run ver.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=005eaf9c1236 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=005eaf9c1236)|2019-03-30 16:43:28
|144|Connor Sheehan |hgserver: add new bundle2 capability to `test-obsolescence-server.t` ( [Bug 1539585](https://bugzilla.mozilla.org/show_bug.cgi?id=1539585)  ) r=larsThis new output was introduced in Mercurial 4.7. The server isnow capable of transmitting v2 stream clone bundles, as shownin this new output. See `hg help internals.wireprotocol.bundle2`for more information on the format of the new content.The output is now alphabetically sorted by default, negating theneed f.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e99a6865db81 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e99a6865db81)|2019-03-30 16:43:28
|145|Connor Sheehan |hgserver: add `content-security-policy` header to `test-static-files.t` output ( [Bug 1539585](https://bugzilla.mozilla.org/show_bug.cgi?id=1539585)  ) r=larsNot long ago we added `hg.mozilla.org/static/` to thecontent security policy. This means that grep-ing for"static" will pick up the header in tests.Differential Revision: https://phabricator.services.mozilla.com/D25386|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e473826ccc95)|2019-03-30 16:43:28
|146|Connor Sheehan |ansible/monitoring-agent: fix indentation in Telegraf restart handlerAccidentally indented one level too many, which causes Ansibleto barf as it doesn't recognize that key for the `service`module.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=9f56254cb36b)|2019-03-28 19:14:17
|147|K Lars Lohn |[Bug 1522496](https://bugzilla.mozilla.org/show_bug.cgi?id=1522496)  step 1 - move implementation of script generate-hg-s3-bundles to .../hgserver/hgmolib r=sheehanThis processed involved using the "entry_point" system in setup_tools for making a newexecutable for generate-hg-s3-bundles. Tests had to be changed to use the new methodof invocation. The original invocation method involved using a "-u" switch on thepython exectuable - this migrated to usi.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=76f73a7f2a56 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=76f73a7f2a56)|2019-03-28 16:31:10
|148|K Lars Lohn |[Bug 1522496](https://bugzilla.mozilla.org/show_bug.cgi?id=1522496)  step 1.5 - simplify testing of known exceptions r=sheehanPrevious versions included tracebacks when a test induced an exception.This added no value to the test and made it more difficult to movedependent modules or upgrade to new versions of Python. The code wasmodified to move from tracebacks with unhandled exceptions to justnoting the exception and associated metadata on stdout bef.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=79691d65850e )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=79691d65850e)|2019-03-28 16:31:10
|149|Connor Sheehan |hgext: add `buglink` field to source formatting related extensionsWith this field added, when either of the extensions errors out,there will be a suggestion to users as to where they should filebugs.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=848dc37f2562)|2019-03-27 17:02:07
|150|Connor Sheehan |ansible/monitoring-host: specify database/retention policy when defining Kapacitor tasksFor whatever reason, one of the|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=cbf8c0e26257)|2019-03-25 17:34:46
|151|Connor Sheehan |ansible/monitoring-host: remove unnecessary alert node from vcsreplicator processes TICKscriptThe `alert` node has been moved lower, to conformto the recommended TICKscript format of "dataframe,thresholds, alert".|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4eb6475ec2f5)|2019-03-25 17:34:46
|152|Connor Sheehan |ansible/monitoring-host: fix formatting of disk space percentagePreviously we were writing the percentage up to 14 digits.This is obviously completely unnecessary, so this commitdisplays only two digits instead.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4b4c40c7d3f7)|2019-03-25 17:34:46
|153|Connor Sheehan |ansible/monitoring-host: fix vcsreplicator consumer lag tickscriptThis commit fixes some minor issues with the existingTICKscript and extends it to include monitoring ofthe vcsreplicator heads process.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=f6a622bc3499)|2019-03-25 17:34:46
|154|Connor Sheehan |ansible/hg-web: add `replicationrules` section to heads consumer config|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=1bacdb36a603)|2019-03-25 17:34:46
|155|Connor Sheehan |ansible/monitoring-agent: add Telegraf restart handlerMaking changes to the Telegraf config file requires arestart of the daemon for changes to take effect. Thiscommit adds a handler to the `monitoring-agent` roleto force a restart when the config file is modifiedon disk.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2d82a492c54d)|2019-03-25 17:34:46
|156|Connor Sheehan |ansible: remove `mozilla-taskcluster` reset reminder from twig reset playbookTaskcluster now triggers job for pushes to Mercurial reposusing Pulse notifications, so there is no need to filea bug for the reset.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=394ce6dbce13)|2019-03-25 14:11:27
|157|Connor Sheehan |configwizard: direct users to tweakdefaults help section during setup ( [Bug 1531059](https://bugzilla.mozilla.org/show_bug.cgi?id=1531059)  ) r=globWe previously pointed users at the `FriendlyHGPlan` Mercurialwiki page. That page has some useful information but has gonestale in recent memory. The information found in the help commandis more recent and will stay relevant from release-to-release.Differential Revision: https://phabricator.services.mozilla.c.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=ed0659b2777d )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=ed0659b2777d)|2019-03-18 16:40:37
|158|Connor Sheehan |configwizard: move `curses` availability check to standalone function ( [Bug 1531059](https://bugzilla.mozilla.org/show_bug.cgi?id=1531059)  ) r=globIt turns out we already check for the presence of `curses`on the system in a separate function in `configwizard`,however the check is coupled with a prompt to enablethe curses interface. Here we move the check itself intoa separate function so we can re-use the functionalityin the next commit.Differential Rev.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=161be99fbe9b )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=161be99fbe9b)|2019-03-18 16:40:37
|159|Connor Sheehan |configwizard: set `ui.interface=text` on Windows ( [Bug 1531059](https://bugzilla.mozilla.org/show_bug.cgi?id=1531059)  ) r=globTweakdefaults causes the default interface to change to `curses`on Windows. This can cause issues as curses is not supported outof the box. This commit adds a check to ensure `curses` is availableon the user's system and reverts the default UI to `text` whenit is not.Differential Revision: https://phabricator.services.mozilla.com.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4520aa3d301e )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=4520aa3d301e)|2019-03-18 16:40:37
|160|Connor Sheehan |robustcheckout: add a `serverUrl` key to CI metrics output ( [Bug 1535011](https://bugzilla.mozilla.org/show_bug.cgi?id=1535011)  ) r=smacleodWith private hg mirrors being rolled out in the near future,we would like to be able to differentiate our CI metricsbetween operations against the public hgmo service, andthe private mirrors. In this commit we parse the url passedto `robustcheckout` using `urlparse.urlparse`, and addthe network location to the outpu.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8e3bb142dfa9 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=8e3bb142dfa9)|2019-03-14 16:43:22
|161|Connor Sheehan |vcsreplicator: sort Telegraf JSON output before printing ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  )Following up on D23175, we should sort the JSON output to ensureconsistency in the tests.|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=787715ced0ac)|2019-03-13 16:00:48
|162|Connor Sheehan |ansible/monitoring-host: install Kapacitor to monitoring host ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globAs a first step towards monitoring hg.mo with the InfluxDB stack,we installed the database, user interface and monitoring agent( InfluxDB, Chronograf and Telegraf, respectively ). Now that wehave some of the basic dashboards and monitoring data beingcollected and queryable, we need to install Kapacitor ( the Influxdata .. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0c90eaaba78e )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=0c90eaaba78e)|2019-03-13 14:52:05
|163|Connor Sheehan |ansible: add a playbook to deploy to monitoring host ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis will be a temporary file that just applies the `monitoring-host`role to a specific host in the inventory. In the future this willbe removed as we send our data to a hosted Influx instance.Differential Revision: https://phabricator.services.mozilla.com/D23171|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=90dd6690c0fc)|2019-03-13 14:52:05
|164|Connor Sheehan |ansible: apply `monitoring-agent` role to hgweb mirrors ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globWe will need this role applied to get data from thehgweb mirrors. Previously we applied the role asa dependency of the hg-web role, but that brokethe test suite as the monitoring role assumedthe presence of the `/var/log/httpd` directory ondisk. It was rolled back in f923e988151c to fixthe test suite.Differential Revision:.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7e9917aaf191 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=7e9917aaf191)|2019-03-13 14:52:05
|165|Connor Sheehan |ansible/monitoring-agent: make `telegraf.conf` a template ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis will allow us to use plugins on relevant hosts basedon different conditions. For example, once we deploy themonitoring agent to the hgssh hosts, we will have no needfor the `Apache` plugin, but we will want to use the `procstat`plugin to monitor the existance of various other processes.Differential Revision: https:/.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e6f32b9d217c )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e6f32b9d217c)|2019-03-13 14:52:05
|166|Connor Sheehan |ansible/monitoring-agent: switch from `systemd_unit` to `pattern` use of `procstat` plugin ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globWhen I attempted to port the vcsreplicator daemon countalert to Kapacitor/TICKscript, I realized that instructingthe `procstat` plugin to monitor a specific systemd unitwould not tell InfluxDB when the unit failed, only whena unit of that name was not loaded into the system. Byswitching t.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=cbaaccde6e74 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=cbaaccde6e74)|2019-03-13 14:52:05
|167|Connor Sheehan |vcsreplicator: add `Telegraf` flag to Nagios checks ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis commit adds a flag to format output from thecustom Nagios checks for consumption by Telegraf.The `exec` Telegraf plugin will query the offsetchecking script with this parameter ( as shown inthe test ) and send the returned value back to Influxfor use in an alerting TICKscript.Differential Revision: https://phabricator.servi.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b1793247e820 )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=b1793247e820)|2019-03-13 14:52:05
|168|Connor Sheehan |ansible/monitoring-agent: enable `exec` Telegraf plugin to check vcsreplicator lag ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis commit adds instances of the `exec` Telegraf pluginwhich poll the vcsreplicator Nagios check for data aboutconsumer lag. A later commit adds a TICKscript to alerton different thresholds of lag.Differential Revision: https://phabricator.services.mozilla.com/D23176|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=930b41909ba3)|2019-03-13 14:52:05
|169|Connor Sheehan |ansible/monitoring-host: add TICKscript to alert for missing vcsreplicator processes ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis commit takes the first step in porting the existing Nagioschecks to the InfluxDB platform ( specifically Kapacitor ). We createan alert which queries the `procstat_lookup` measurement for pointswith a `pattern` tag matching "vcsreplicator-consumer". Whenwe do not find 8 running systemd units.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=827037a767ad )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=827037a767ad)|2019-03-13 14:52:05
|170|Connor Sheehan |ansible/monitoring-host: add a TICKscript to check vcsreplicator consumer lag ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globBuilding on previous commits, this commit adds a TICKscriptto monitor vcsreplicator consumer lag data pulled from the`exec` Telegraf plugin.Differential Revision: https://phabricator.services.mozilla.com/D23178|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=a52b64093d31)|2019-03-13 14:52:05
|171|Connor Sheehan |ansible/monitoring-host: add a TICKscript to monitor remaining disk space ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis commit adds a TICKscript to alert on high disk space usage.Thresholds are adapted from existing IT Nagios checks.Differential Revision: https://phabricator.services.mozilla.com/D23179|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=2885a2a097ba)|2019-03-13 14:52:05
|172|Connor Sheehan |ansible/monitoring-host: add a TICKscript to monitor system load ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis commit adds a TICKscript to monitor high load onmonitored instances. Thresholds are adapted fromexisting IT Nagios checks.Differential Revision: https://phabricator.services.mozilla.com/D23180|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=ff1acf3da77a)|2019-03-13 14:52:05
|173|Connor Sheehan |ansible/monitoring-host: install Kapacitor tasks to monitoring host ( [Bug 1525954](https://bugzilla.mozilla.org/show_bug.cgi?id=1525954)  ) r=globThis commit installs our new TICKscripts on the testmonitoring host.Differential Revision: https://phabricator.services.mozilla.com/D23181|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=e95b70411f81)|2019-03-13 14:52:05
|174|Steve Fink |[Bug 1511093](https://bugzilla.mozilla.org/show_bug.cgi?id=1511093)  - Minor spelling and wording fixes r=andiDifferential Revision: https://phabricator.services.mozilla.com/D16371|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=68f59905d10e)|2019-03-12 22:59:17
|175|Ludovic Hirlimann |pash: Change component where bugs are file when Mercurial accounts are disabled because of inactivity. Move from Moc Service Request to LDAP. [Bug 1532963](https://bugzilla.mozilla.org/show_bug.cgi?id=1532963)  r=sheehanBefore this change, when an account is expired the message displayed says to open a bug in Moc Service request. Moc is no more , changing the message to file a bug in the LDAP component.Differential Revision: https://phabricator.services.. [continue reading]( https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=33ee1b57476c )|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=33ee1b57476c)|2019-03-07 14:45:51
|176|K Lars Lohn |[Bug 1523745](https://bugzilla.mozilla.org/show_bug.cgi?id=1523745)  removed implementation of mozbuild-info r=sheehanDifferential Revision: https://phabricator.services.mozilla.com/D21768|[URL](https://hg.mozilla.org/hgcustom/version-control-tools/pushloghtml?changeset=6160c590b717)|2019-03-04 18:53:18
